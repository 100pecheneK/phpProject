<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <a href="/">НАЗАД</a>
    <pre>
        Таймкоды_1: https://www.youtube.com/watch?v=p1NucoC_ZLo&t=24s
        ─────────────────────────────────────────────────────────
        2:00 Проверяем/Меняем версию PHP
        6:10 Качаем/Подключаем RedBeanPHP
        8:40 Подключаемся к базе данных R::setup()
        9:50 В чём разница между utf8_general_ci и utf8mb4_general_ci
        11:45 Почему нужно прописывать IP в качестве хоста базы данных
        ─────────────────────────────────────────────────────────
        14:45 Закрытие соединения с базой данных R::close()
        15:10 Проверяем соединение с базой данных R::testConnection()
        16:00 Выполняем произвольный SQL код R::exec()
        20:20 Что такое CRUD
        21:00 Создание записей R::dispense()
        27:50 О режиме заморозки R::freeze()
        ─────────────────────────────────────────────────────────
        30:45 Конвенция именования таблиц
        32:20 Пишем обход конвенций именования таблиц R::ext()
        34:00 Конвенция именования свойств бина
        34:40 Конвенция автосоздания индексов
        ─────────────────────────────────────────────────────────
        37:20 Загружаем записи R::load()
        41:00 Загружаем сразу несколько записей R::loadAll()
        42:30 Поиск записей R::find()
        44:20 Генерируем бинд слоты R::genSlots()
        46:40 Ищем только одну запись R::findOne()
        47:25 Загружаем все записи сразу R::findAll()
        48:10 Итерация по всем записям R::findCollection()
        49:40 Ищем записи по значениям R::findLike()
        51:30 Загружаем запись если есть, создаем и загружаем если нет R::findOrCreate()
        53:15 Считаем количество записей R::count()
        ─────────────────────────────────────────────────────────
        54:35 Обновляем данные в записях
        59:00 Удаляем записи из таблиц
        1:00:18 Вайпаем данные таблиц (очищаем таблицы) R::wipe()
        1:00:47 Очищаем всю базу данных R::nuke()
        1:01:50 Что будем в следующих уроках?
        ─────────────────────────────────────────────────────────
        Таймкоды_2: https://www.youtube.com/watch?v=iU8zlbkpwyo&t=4s
        ─────────────────────────────────────────────────────────
        1:33 Почему нельзя копировать вообще весь код из урока
        2:45 Метод R::getAll()
        6:09 Метод R::getRow()
        10:45 Метод R::getCol()
        15:00 Методы R::convertToBean() и R::convertToBeans(), перекидываем массивы в бины
        16:44 Метод R::getInsertID()
        ─────────────────────────────────────────────────────────
        19:42 Что такое отношения вообще?
        23:45 Отношения One-to-Many (1:M)
        40:06 Отношения Many-to-One (M:1)
        44:35 Отношения One-to-X (One-to-Fixed)(-)
        53:30 Отношения Many-to-Many (M2M)
        ─────────────────────────────────────────────────────────
        57:40 Сортировка отношений
        59:55 Фильтрация отношений
        1:02:55 Добавляем отношения без их подгрузки
        1:04:30 Подсчёт отношений/связей
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        8:40 Подключаемся к базе данных R::setup()
        15:10 Проверяем соединение с базой данных R::testConnection()
        
        require "rb.php";
        R::setup('host=<айпишник(127.0.0.1)>'; dbname=<имя_БД>, 'root', '');
        if (R::testConnection()){
            exit('Нет подключения к Базе Данных>');
        }
        ─────────────────────────────────────────────────────────
        21:00 Создание записей R::dispense()
        
        $var = R::dispense('<имя_таблицы>');
        $var-><поле> = 'значение';
        R::store($var);
        ─────────────────────────────────────────────────────────
        32:20 Пишем обход конвенций именования таблиц R::ext()
        
        $id = $_GET['id'];
        R::exec('DELETE FROM `<имя_БД>` WHERE `id` = ?', array($id));
        ─────────────────────────────────────────────────────────
        41:00 Загружаем сразу несколько записей R::loadAll()
        
        $vars = R:loadAll('<имя_таблицы>', array(1, 2, 3));
        foreach($vars as $var){
            echo $var-><имя_поля>;
            //echo $var['<имя_поля>']
        }
        ─────────────────────────────────────────────────────────
        42:30 Поиск записей R::find()
        44:20 Генерируем бинд слоты R::genSlots()
        46:40 Ищем только одну запись R::findOne()
        47:25 Загружаем все записи сразу R::findAll()
        48:10 Итерация по всем записям R::findCollection()
        49:40 Ищем записи по значениям R::findLike()
        51:30 Загружаем запись если есть, создаем и загружаем если нет R::findOrCreate()
        53:15 Считаем количество записей R::count()
        
        $var = R::find('<имя_таблицы>', "<поле> > ? ORDER BY '<поле>' DESC", array(<значение>));
        ──
        $ids = array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
        R::exec("DELETE FROM `<имя_таблицы>` WHERE `id` IN(" . R::genSlots($ids) . ")", $ids);
        ──
        $var = R::findOne('<имя_таблицы>', "`<поле>` = ?", array(<значение>));
        ──
        $vars = R::findAll('<имя_таблицы>',"ORDER BY `поле` DESC");
        ──
        $vars = R::findAll('<имя_таблицы>');
        foreach($vars as $v){
            $v-><поле> = $v-><поле> + 1;
            //R::store($v);
        }
        R::storeAll($vars);
        ──
        $vars = R::findCollection(`<имя_таблицы>`, "ORDER BY `<поле>` DESC");
        while($var = $vars->next()){
            echo $var-><поле>;
        }
        ──
        $var = R::findLike('<имя_таблицы>', array('<поле>' => array('значение', 'значение'), 'ORDER BY `поле` ASC'));
        ──
        $var = R::findOrCreate('<имя_таблицы>', array('<поле>' => '<Значение>'));
        ──
        echo R::count('<имя_таблицы>');
        ─────────────────────────────────────────────────────────
        54:35 Обновляем данные в записях R::load()
        
        $var = R::load('<имя_таблицы>', <айди>);
        $var-><поле> = '<значение поля>';
        R::store($var);
        ─────────────────────────────────────────────────────────
        59:00 Удаляем записи из таблиц
        
        $var = R::load('<имя_таблицы>', '<айди>');
        R::trash($var);
        //сначала запросить бобы
        //R::trashAll($vars)
        ─────────────────────────────────────────────────────────
        1:00:18 Вайпаем данные таблиц (очищаем таблицы) R::wipe()
        
        R::wipe('<имя_таблицы>');
        ─────────────────────────────────────────────────────────
        1:00:47 Очищаем всю базу данных R::nuke()
        
        R::nuke();
        ─────────────────────────────────────────────────────────
        2:45 Метод R::getAll()
        
        R::getAll("SELECT * FROM `<имя_таблицы>` ORDER BY `<поле>`");
        ─────────────────────────────────────────────────────────
        6:09 Метод R::getRow()
        
        R::getRow("SELECT * FROM `<имя_таблицы>` ORDER BY `<поле>` LIMIT 1");
        ─────────────────────────────────────────────────────────
        10:45 Метод R::getCol()
        
        R::getCol("SELECT `<поле>` FROM `<имя_таблицы>` ORDER BY `<поле>`");
        ─────────────────────────────────────────────────────────
        15:00 Методы R::convertToBean() и R::convertToBeans(), перекидываем массивы в бины
        
        R::convertToBean('<имя_БД>', $var['<айди>']);
        R::convertToBeans('<имя_БД>', $var);
        ─────────────────────────────────────────────────────────
        16:44 Метод R::getInsertID()
        
        R::exec("INSERT INTO `<имя_БД>` (`<поле>`) VALUES('<значение>')");
        exho 'Last insert id: ' . R::getInsertID();
        
        или
        
        $id = R::store($var);
        exho 'Last insert id: ' . $id;
        ─────────────────────────────────────────────────────────
        23:45 Отношения One-to-Many (1:M)
        
        Добавление
        
        $player = R::dispence('player');
        $player->nickname = 'Котэ_фтапках';
        
        $item = R::dispense('item');
        $item->type = 'pistol';
        $item->model = 'Five';
        $item->quantity = 1;
        
        $item2 = R::discpense('item');
        $item2->type = 'potion';
        $item2->model = 'Heal';
        $item2->qiantity = 7;
        
        $player->ownItemList[] = $item;
        $player->ownItemList[] = $item2;
        R::store($player);
        
        Загрузка
        
        $player = R::load('player', 1);
        
        echo 'Персонаж: ' . $player->nickname;
        
        foreach($player->ownItemList as $item) {
            echo $item->model . '(x' . $item->quantitu . ')';
        }
        
        Удаление
        
        $player = R::load('player', 1);
        R::trash($player->ownItemList['1']);
        
        Разрыв связи
        
        $player = R::load('player', 1);
        unset($player->ownItemList['2']);
        R::store($player);
        
        Разрыв связи с удалением
        
        $player = R::load('player', 1);
        unset($player->xownItemList['2']);
        R::store($player);
        ─────────────────────────────────────────────────────────
        40:06 Отношения Many-to-One (M:1)
        
        $item = R::dispence('item');
        $item2->type = 'potion';
        $item2->model = 'Heal';
        $item2->qiantity = 7;
        
        $item->player = R::load('player', 1);
        
        R::store($item);
        
        Загрузка
        
        $item = R::load('item', 2);
        print_r($item->player);
        ─────────────────────────────────────────────────────────
        53:30 Отношения Many-to-Many (M2M)
        
        list($article1, $article2) = R::dispence('article', 2);
        
        $article->title = 'Изучаем RBPHP';
        $article->content = '...';
        
        $article->title = 'Отношения RBPHP';
        $article->content = '...';
        
        $tag = R::dispence('tag');
        $tag->name = 'RBPHP';
        
        $article1->sharedTagList[] = $tag;
        $article2->sharedTagList[] = $tag;
        
        R::storeAll(array($article1, $article2));
        ─────────────────────────────────────────────────────────
        57:40 Сортировка отношений
        
        $player = R::load('player', 1);
        $player_item = $player->with('ORDER BY `price` DESC')->ownItemList;
        
        foreach($player_item as $item) {
            echo $item['title'] . $item['price'];
        }
        ─────────────────────────────────────────────────────────
        59:55 Фильтрация отношений
        
        $player = R::load('player', 1);
        $player_item = $player->withCondition('`type` = "shield" ORDER BY `price` DESC')->ownItemList;
        
        foreach($player_item as $item) {
            echo $item['title'] . $item['price'];
        }
        ─────────────────────────────────────────────────────────
        1:02:55 Добавляем отношения без их подгрузки
        
        $player = R::load('player', 1);
        
        $nitem = R::dispence('item');
        $nitem->type = 'gold';
        
        $player->noLoad()->ownItemList[] = $nitem;
        
        R::store($player);
        ─────────────────────────────────────────────────────────
        1:04:30 Подсчёт отношений/связей
        
        echo $player->countOwn('item');
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        ─────────────────────────────────────────────────────────
        
</body>
</html>
